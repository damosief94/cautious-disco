name: Ultimate-Win-CRD

on: 
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: Download Chrome Installer
        run: |
          Invoke-WebRequest -Uri "https://dl.google.com/chrome/install/latest/chrome_installer.exe" -OutFile "chrome_installer.exe"
          Start-Process -FilePath "chrome_installer.exe" -Args "/silent /install" -Wait

      - name: Download CRD Installer
        run: |
          Invoke-WebRequest -Uri "https://dl.google.com/edgedl/chrome-remote-desktop/chromeremotedesktophost.msi" -OutFile "crd.msi"
          Start-Process -FilePath "msiexec.exe" -Args "/i crd.msi /quiet /qn" -Wait

      - name: Start Chrome Remote Desktop
        env:
          CRD_CODE: ${{ secrets.CRD_CODE }}
          CRD_PIN: ${{ secrets.CRD_PIN }}
        run: |
          # Ø¯Ù…Ø¬ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø¹ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±
          $Command = $env:CRD_CODE + " -pin=" + $env:CRD_PIN
          Invoke-Expression $Command

      - name: Success Message
        run: |
          Write-Host "======================================================"
          Write-Host "âœ… The Server is RUNNING on Google Servers!"
          Write-Host "ğŸ”— Go to: https://remotedesktop.google.com/access"
          Write-Host "ğŸ‘‰ You will see 'runner' online. Click to connect."
          Write-Host "======================================================"

      - name: Keep Alive
        run: |
          while ($true) { Start-Sleep -Seconds 300 }
